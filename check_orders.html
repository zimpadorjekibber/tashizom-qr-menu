<!DOCTYPE html>
<html>

<body>
    <h1>Latest Orders</h1>
    <div id="output">Loading...</div>
    <script type="module">
        import { db } from './firebase-config.js';
        import { collection, getDocs, orderBy, query, limit } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        async function checkOrders() {
            try {
                // Query the 'orders' collection
                const ordersRef = collection(db, "orders");
                // Attempt to order by timestamp descending to get the latest
                const q = query(ordersRef, orderBy("createdAt", "desc"), limit(5));

                const querySnapshot = await getDocs(q);

                const orders = [];
                querySnapshot.forEach((doc) => {
                    orders.push({ id: doc.id, ...doc.data() });
                });

                document.getElementById('output').innerText = JSON.stringify(orders, null, 2);
            } catch (e) {
                // If index is missing, it might fail on orderBy, fallback to simple fetch
                if (e.message.includes("indexes")) {
                    document.getElementById('output').innerText = "Index missing error (expected for first run). Falling back to basic fetch.";
                    // Fallback logic could be added here if needed, but for now knowing it fails is enough info
                }
                document.getElementById('output').innerText = "Error: " + e.message;
            }
        }
        checkOrders();
    </script>
</body>

</html>