<!DOCTYPE html>
<html>

<head>
    <title>Restore Menu Data</title>
</head>

<body>
    <h1>Restoring Menu Data...</h1>
    <div id="status">Starting...</div>
    <script type="module">
        import { db } from './firebase-config.js';
        import { collection, getDocs, deleteDoc, addDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const originalData = [
            {
                name: "Truffle Mushroom Pasta",
                description: "Creamy fettuccine with black truffle oil, parmesan, and wild mushrooms.",
                price: 18.00,
                category: "main-course",
                image: "https://images.unsplash.com/photo-1473093295043-cdd812d0e601?auto=format&fit=crop&w=800&q=80"
            },
            {
                name: "Signature Beef Burger",
                description: "Wagyu beef patty, aged cheddar, caramelized onions, and secret sauce on brioche.",
                price: 16.50,
                category: "main-course",
                image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?auto=format&fit=crop&w=800&q=80"
            },
            {
                name: "Premium Sushi Platter",
                description: "Chef's selection of fresh nigiri, sashimi, and signature rolls.",
                price: 32.00,
                category: "main-course",
                image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c?auto=format&fit=crop&w=800&q=80"
            },
            {
                name: "Crispy Calamari",
                description: "Golden fried calamari rings served with lemon aioli and spicy marinara.",
                price: 12.00,
                category: "starters",
                image: "https://images.unsplash.com/photo-1604909052743-94e838986d24?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
            },
            {
                name: "Mango Sticky Rice",
                description: "Sweet coconut sticky rice served with fresh ripe mango and sesame seeds.",
                price: 9.00,
                category: "desserts",
                image: "https://images.unsplash.com/photo-1548811264-c3fd9b92512b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
            },
            {
                name: "Thai Iced Tea",
                description: "Classic Thai tea with condensed milk and ice.",
                price: 5.00,
                category: "beverages",
                image: "https://images.unsplash.com/photo-1595981267035-7b04ca84a82d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
            }
        ];

        async function restore() {
            const status = document.getElementById('status');
            try {
                // 1. Delete existing items
                status.innerText = 'Deleting old items...';
                const snapshot = await getDocs(collection(db, "menuItems"));
                const deletePromises = [];
                snapshot.forEach(docSnap => {
                    deletePromises.push(deleteDoc(doc(db, "menuItems", docSnap.id)));
                });
                await Promise.all(deletePromises);

                // 2. Add high quality items
                status.innerText = 'Adding high quality items...';
                for (const item of originalData) {
                    await addDoc(collection(db, "menuItems"), item);
                }

                status.innerText = 'Success! Menu restored. You can close this page.';
                alert('Menu has been restored with high quality images!');
            } catch (e) {
                status.innerText = 'Error: ' + e.message;
                console.error(e);
            }
        }

        restore();
    </script>
</body>

</html>